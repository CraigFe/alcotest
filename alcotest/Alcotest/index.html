<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Alcotest (alcotest.Alcotest)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">alcotest</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Alcotest</span></h1></header><p>A lightweight and colourful test framework.</p><p><code class="code">Alcotest</code> provides a simple interface to perform unit tests. It
exposes a simple <a href="module-type-TESTABLE/index.html">TESTABLE</a> module type, a
<a href="index.html#val-check">check function</a> to assert test predicates and a
<a href="index.html#val-run">run</a> function to perform a list of <code class="code">unit -&gt; unit</code> test
callbacks.</p><p>From these descriptions, <code class="code">Alcotest</code> builds a quiet and colorful
output where only faulty runs are fully displayed at the end of
the run (with the full logs ready to inspect), with a simple (yet
expressive) query language to select the tests to run.</p><p><em>Release 0.8.2</em></p><div class="spec type" id="type-speed_level"><a href="#type-speed_level" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>speed_level</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-speed_level.Quick" class="anchored"><td class="def constructor"><a href="#type-speed_level.Quick" class="anchor"></a><code><span class="keyword">| </span></code><code>`Quick</code></td></tr><tr id="type-speed_level.Slow" class="anchored"><td class="def constructor"><a href="#type-speed_level.Slow" class="anchor"></a><code><span class="keyword">| </span></code><code>`Slow</code></td></tr></table><code> ]</code><code></code></div><div class="doc"><p>Speed level for a test.</p></div></div><div class="spec type" id="type-test_case"><a href="#type-test_case" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a test_case</code><code><span class="keyword"> = </span>string<span class="keyword"> * </span><a href="index.html#type-speed_level">speed_level</a><span class="keyword"> * </span>(<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> unit)</code><code></code></div><div class="doc"><p>A test case is an UTF-8 encoded documentation string, a speed
level and a function to execute.</p></div></div><div class="spec val" id="val-test_case"><a href="#val-test_case" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>test_case : string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-speed_level">speed_level</a> <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-test_case">test_case</a></code></div><div class="doc"><p><code class="code">test_case n s f</code> is the test case <code class="code">n</code> running at speed <code class="code">s</code> using
the function <code class="code">f</code>.</p></div></div><div class="spec type" id="type-test"><a href="#type-test" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a test</code><code><span class="keyword"> = </span>string<span class="keyword"> * </span><span class="type-var">'a</span> <a href="index.html#type-test_case">test_case</a> list</code><code></code></div><div class="doc"><p>A test is an US-ASCII encoded name and a list of test cases.</p></div></div><div class="spec exception" id="exception-Test_error"><a href="#exception-Test_error" class="anchor"></a><div class="def exception"><code><span class="keyword">exception </span></code><code><span class="exception">Test_error</span></code></div><div class="doc"><p>The exception return by <a href="index.html#val-run">run</a> in case of errors.</p></div></div><div class="spec val" id="val-run"><a href="#val-run" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>run : ?&#8288;and_exit:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;argv:string array <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-test">test</a> list <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">run n t</code> runs the test suite <code class="code">t</code>. <code class="code">n</code> is the name of the
tested library.</p><p>The optional argument <code class="code">and_exit</code> controls what happens when the
function ends. By default, <code class="code">and_exit</code> is set, which makes the
function exit with <code class="code">0</code> if everything is fine or <code class="code">1</code> if there is an
issue. If <code class="code">and_exit</code> is <code class="code">false</code>, then the function raises
<code class="code">Test_error</code> on error.</p><p>The optional argument <code class="code">argv</code> specifies the argument sent to
alcotest like <code class="code">&quot;--json&quot;</code>, <code class="code">&quot;--verbose&quot;</code>, etc. (at least one
argument is required).</p></div></div><div class="spec val" id="val-run_with_args"><a href="#val-run_with_args" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>run_with_args : ?&#8288;and_exit:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;argv:string array <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> Cmdliner.Term.t <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-test">test</a> list <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">run_with_args n a t</code> Similar to <code class="code">run a t</code> but take an extra
argument <code class="code">a</code>. Every test function will receive as arguement the
evaluation of the <code class="code">Cdmliner</code> term <code class="code">a</code>: this is useful to configure
the test behaviors using the CLI.</p></div></div><h2>Assert functions</h2><div class="spec module-type" id="module-type-TESTABLE"><a href="#module-type-TESTABLE" class="anchor"></a><div class="def module-type"><code><span class="keyword">module type </span><a href="module-type-TESTABLE/index.html">TESTABLE</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><p><code class="code">TESTABLE</code> provides an abstract description for testable
values.</p></div></div><div class="spec type" id="type-testable"><a href="#type-testable" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a testable</code><code><span class="keyword"> = </span>(<span class="keyword">module </span><a href="module-type-TESTABLE/index.html">TESTABLE</a> <span class="keyword">with</span> <span class="keyword">type </span><a href="module-type-TESTABLE/index.html#type-t">t</a> <span class="keyword">=</span> <span class="type-var">'a</span>)</code><code></code></div><div class="doc"><p>The type for testable values.</p></div></div><div class="spec val" id="val-testable"><a href="#val-testable" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>testable : <span class="type-var">'a</span> Fmt.t <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> bool) <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">testable pp eq</code> is a new <a href="index.html#type-testable">testable</a> with the pretty-printer <code class="code">pp</code> and
equality <code class="code">eq</code>.</p></div></div><div class="spec val" id="val-pp"><a href="#val-pp" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> Fmt.t</code></div><div class="doc"><p><code class="code">pp t</code> is <code class="code">t</code>'s pretty-printer.</p></div></div><div class="spec val" id="val-equal"><a href="#val-equal" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>equal : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p><code class="code">equal t</code> is <code class="code">t</code>'s equality.</p></div></div><div class="spec val" id="val-bool"><a href="#val-bool" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>bool : bool <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">bool</code> tests booleans.</p></div></div><div class="spec val" id="val-int"><a href="#val-int" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>int : int <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">int</code> tests integers.</p></div></div><div class="spec val" id="val-int32"><a href="#val-int32" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>int32 : int32 <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">int32</code> tests 32-bit integers.</p></div></div><div class="spec val" id="val-int64"><a href="#val-int64" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>int64 : int64 <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">int64</code> tests 64-bit integers.</p></div></div><div class="spec val" id="val-float"><a href="#val-float" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>float : float <span class="keyword">&#8209;&gt;</span> float <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">float</code> tests floats with specified absolute error.</p></div></div><div class="spec val" id="val-char"><a href="#val-char" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>char : char <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">char</code> tests characters.</p></div></div><div class="spec val" id="val-string"><a href="#val-string" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>string : string <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">string</code> tests OCaml strings.</p></div></div><div class="spec val" id="val-unit"><a href="#val-unit" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>unit : unit <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">unit</code> tests unit values (useful for functions with side-effects).</p></div></div><div class="spec val" id="val-list"><a href="#val-list" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>list : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> list <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">list t</code> tests lists of <code class="code">t</code>s.</p></div></div><div class="spec val" id="val-slist"><a href="#val-slist" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>slist : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> int) <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> list <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">slist t comp</code> tests sorted lists of <code class="code">t</code>s. The list are sorted
using <code class="code">comp</code>.</p></div></div><div class="spec val" id="val-array"><a href="#val-array" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>array : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> array <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">array t</code> tests arrays of <code class="code">t</code>s.</p></div></div><div class="spec val" id="val-option"><a href="#val-option" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>option : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> option <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">option t</code> tests optional <code class="code">t</code>s.</p></div></div><div class="spec val" id="val-result"><a href="#val-result" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>result : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'e</span>) Result.result <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">result t e</code> tests <code class="code">t</code>s on success and <code class="code">e</code>s on failure.</p></div></div><div class="spec val" id="val-pair"><a href="#val-pair" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pair : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span><span class="keyword"> * </span><span class="type-var">'b</span>) <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">pair a b</code> tests pairs of <code class="code">a</code>s and <code class="code">b</code>s.</p></div></div><div class="spec val" id="val-of_pp"><a href="#val-of_pp" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>of_pp : <span class="type-var">'a</span> Fmt.t <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">of_pp pp</code> tests values which can be printed using <code class="code">pp</code> and
compared using Pervasives.compare</p></div></div><div class="spec val" id="val-pass"><a href="#val-pass" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pass : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">pass</code> tests values of any type and always succeeds.</p></div></div><div class="spec val" id="val-reject"><a href="#val-reject" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>reject : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">reject</code> tests values of any type and always fails.</p></div></div><div class="spec val" id="val-check"><a href="#val-check" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>check : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Check that two values are equal.</p></div></div><div class="spec val" id="val-fail"><a href="#val-fail" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>fail : string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span></code></div><div class="doc"><p>Simply fail.</p></div></div><div class="spec val" id="val-failf"><a href="#val-failf" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>failf : (<span class="type-var">'a</span>, Format.formatter, unit, <span class="type-var">'b</span>) Pervasives.format4 <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span></code></div><div class="doc"><p>Simply fail with a formatted message.</p></div></div><div class="spec val" id="val-neg"><a href="#val-neg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>neg : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></div><div class="doc"><p><code class="code">neg t</code> is <code class="code">t</code>'s negation: it is <code class="code">true</code> when <code class="code">t</code> is <code class="code">false</code> and it
is <code class="code">false</code> when <code class="code">t</code> is <code class="code">true</code>.</p></div></div><div class="spec val" id="val-check_raises"><a href="#val-check_raises" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>check_raises : string <span class="keyword">&#8209;&gt;</span> exn <span class="keyword">&#8209;&gt;</span> (unit <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Check that an exception is raised.</p></div></div><h2>Deprecated</h2><div class="spec val" id="val-line"><a href="#val-line" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>line : Pervasives.out_channel <span class="keyword">&#8209;&gt;</span> ?&#8288;color:[ `Blue | `Yellow ] <span class="keyword">&#8209;&gt;</span> char <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><ul class="at-tag"><li><p><span class="at-tag deprecated">Deprecated</span> You should write your own line function. For instance:
</p><pre><code class="code">
let line ppf ?color c =
  let line = String.v ~len:terminal_columns (fun _ -&gt; c) in
  match color with
  | Some c -&gt; Fmt.pf ppf &quot;%a\n%!&quot; Fmt.(styled c string)  line
  | None   -&gt; Fmt.pf ppf &quot;%s\n%!&quot;line
</code></pre></li></ul></div></div></body></html>